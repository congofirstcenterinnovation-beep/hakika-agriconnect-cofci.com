<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hakika Agriconnect</title>

<!-- Fonts et styles -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<!-- Chart JS -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- PWA Manifest -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1a4d2e">

<!-- Styles -->
<style>
body{margin:0;font-family:Poppins;background:#050b18;color:#dbeafe;scroll-behavior:smooth;}
nav{position:fixed;top:0;width:100%;background:rgba(5,11,24,0.95);backdrop-filter:blur(10px);padding:15px;z-index:1000;}
nav ul{display:flex;justify-content:center;gap:25px;list-style:none;margin:0;padding:0;}
nav a{color:#60a5fa;text-decoration:none;font-weight:600;transition:0.3s;}
nav a:hover{color:#93c5fd;}
section{min-height:100vh;padding:100px 20px;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;background-size:cover;background-position:center;scroll-margin-top:80px;}
h1{font-size:40px;margin-bottom:10px;} h2{color:#93c5fd;}
.card{background:rgba(15,23,42,0.85);padding:20px;border-radius:15px;margin:15px;width:320px;box-shadow:0 0 20px rgba(96,165,250,0.3);transition:0.3s;}
.card:hover{transform:translateY(-5px);box-shadow:0 0 25px rgba(96,165,250,0.5);}
input,textarea,select{width:90%;padding:12px;margin:10px 0;border:none;border-radius:8px;background:#020617;color:white;}
button{padding:12px 20px;border:none;border-radius:8px;background:#2563eb;color:white;cursor:pointer;transition:0.3s;}
button:hover{background:#1d4ed8;transform:scale(1.05);}
.grid{display:flex;flex-wrap:wrap;justify-content:center;gap:15px;}
#chatBox{height:250px;overflow-y:auto;background:#020617;padding:10px;border-radius:10px;margin-bottom:10px;width:300px;}
img.agri{width:100%;border-radius:12px;margin-top:10px;}
#map{height:300px;width:90%;border-radius:12px;margin-top:10px;}
footer{background:rgba(5,11,24,0.9);color:#60a5fa;padding:20px;text-align:center;}
footer a{color:#60a5fa;margin:0 10px;text-decoration:none;}
footer a:hover{color:#93c5fd;}
#footerLoginBtn{margin-top:10px;}
</style>
</head>
<body>

<!-- Service Worker -->
<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js")
    .then(() => console.log("Service Worker activé"))
    .catch(err => console.log("Erreur Service Worker:", err));
}
</script>
</head>
<body>
<nav>
<ul>
<li><a href="#home">Accueil</a></li>
<li><a href="#about">À propos</a></li>
<li><a href="#market">Marketplace</a></li>
<li><a href="#chat">Chat</a></li>
<li><a href="#geo">Géolocalisation</a></li>
<li><a href="#meteo">Météo</a></li>
<li><a href="#stats">Statistiques</a></li>
<li><a href="#ai">Assistant IA</a></li>
<li><a href="#partner">Partenaire</a></li>
</ul>
</nav>

<!-- 1 ACCUEIL -->
<section id="home" style="background-image:url('https://images.unsplash.com/photo-1592982537447-6d96e902ef4c');">
<h1>Hakika Agriconnect</h1>
<h2>Connecter les agriculteurs africains au marché réel</h2>
<p>Produisez. Publiez. Vendez. Transformez votre récolte en opportunité.</p>
<div class="card">
<h3>Assistant IA agricole</h3>
<div id="aiBoxHome"></div>
<input id="aiInputHome" placeholder="Pose ta question agricole">
<button onclick="askAIHome()">Demander</button>
</div>
</section>

<!-- 2 A PROPOS -->
<section id="about" style="background-image:url('https://images.unsplash.com/photo-1500937386664-56d1dfef3854');">
<h1>Notre mission</h1>
<div class="card">
<p>Hakika Agriconnect digitalise l'agriculture locale et connecte producteurs, acheteurs et investisseurs.</p>
<img class="agri" src="https://images.unsplash.com/photo-1574943320219-553eb213f72d">
</div>
</section>

<!-- 3 MARKETPLACE -->
<section id="market" style="background-image:url('https://images.unsplash.com/photo-1464226184884-fa280b87c399');">
<h1>Marketplace agricole</h1>
<div class="card">
<input id="prodName" placeholder="Nom du produit">
<input type="file" id="prodImg">
<select id="payMethod">
<option value="Orange Money">Orange Money</option>
<option value="Airtel Money">Airtel Money</option>
<option value="Vodacom Money">Vodacom Money</option>
</select>
<button onclick="addProduct()">Publier produit</button>
</div>
<div id="products" class="grid"></div>
</section>

<!-- 4 CHAT -->
<section id="chat" style="background-image:url('https://images.unsplash.com/photo-1523741543316-beb7fc7023d8');">
<h1>Espace discussion producteurs</h1>
<div id="chatBox"></div>
<input id="chatInput" placeholder="Votre message">
<button onclick="sendMsg()">Envoyer</button>
</section>

<!-- 5 GEO -->
<section id="geo" style="background-image:url('https://images.unsplash.com/photo-1500530855697-b586d89ba3ee');">
<h1>Localiser votre champ</h1>
<button onclick="geo()">Afficher ma position</button>
<p id="geoResult"></p>
<div id="map"></div>
</section>

<!-- 6 METEO -->
<section id="meteo" style="background-image:url('https://images.unsplash.com/photo-1504384308090-c894fdcc538d');">
<h1>Météo Goma IA</h1>
<div class="card" id="weatherCard">
<p id="weatherDesc"></p>
<p id="weatherTemp"></p>
<p id="weatherHum"></p>
<p id="weatherWind"></p>
<p id="weatherSun"></p>
</div>
</section>

<!-- 7 STATS -->
<section id="stats" style="background-image:url('https://images.unsplash.com/photo-1454165804606-c3d57bc86b40');">
<h1>Statistiques agricoles</h1>
<canvas id="chart" width="300"></canvas>
</section>

<!-- 8 IA -->
<section id="ai" style="background-image:url('https://images.unsplash.com/photo-1518779578993-ec3579fee39f');">
<h1>Assistant IA agricole</h1>
<div id="aiBox"></div>
<input id="aiInput" placeholder="Pose ta question agricole">
<button onclick="askAI()">Demander</button>
</section>

<!-- 9 LOGIN -->
<section id="login" style="background-image:url('https://images.unsplash.com/photo-1522202176988-66273c2fd55f');display:none;">
<h1>Espace utilisateur</h1>
<input id="email" placeholder="Email">
<input id="password" placeholder="Mot de passe">
<button onclick="loginUser()">Connexion</button>
<h2>Créer compte</h2>
<input id="fullname" placeholder="Nom complet">
<input id="phone" placeholder="Téléphone">
<input id="newEmail" placeholder="Email">
<input id="newPassword" placeholder="Mot de passe">
<button onclick="createUser()">Créer</button>
</section>

<!-- 10 PARTENAIRE -->
<section id="partner" style="background-image:url('https://images.unsplash.com/photo-1507679799987-c73779587ccf');">
<h1>Devenir partenaire Hakika</h1>
<input placeholder="Nom entreprise">
<input placeholder="Contact">
<textarea placeholder="Proposition partenariat"></textarea>
<button>Envoyer demande</button>
</section>

<footer>
<a href="#">FAQ</a> | <a href="#">Confidentialité</a>
<br>
<button id="footerLoginBtn" onclick="document.getElementById('login').scrollIntoView({behavior:'smooth'})">Se connecter</button>
</footer>

<script>
// ===== FIREBASE CONFIG =====
const firebaseConfig = {
apiKey: "AIzaSyADgmdNHD9czAWeAkR_eEJS3OHbqBg8Rd4",
authDomain: "hakika-agriconnect-cofci-3a733.firebaseapp.com",
databaseURL: "https://hakika-agriconnect-cofci-3a733-default-rtdb.firebaseio.com",
projectId: "hakika-agriconnect-cofci-3a733",
storageBucket: "hakika-agriconnect-cofci-3a733.appspot.com",
messagingSenderId: "395415064040",
appId: "1:395415064040:web:9bf84863feeb20a918285d",
measurementId: "G-T72RE8Z3X2"
};
firebase.initializeApp(firebaseConfig);
const auth=firebase.auth();
const db=firebase.database();
const storage=firebase.storage();

// ===== AUTH =====
function createUser(){
  const email=document.getElementById("newEmail").value;
  const password=document.getElementById("newPassword").value;
  const fullname=document.getElementById("fullname").value;
  const phone=document.getElementById("phone").value;
  auth.createUserWithEmailAndPassword(email,password)
  .then(user=>{
    db.ref('users/'+user.user.uid).set({fullname,email,phone});
    alert("Compte créé !");
  }).catch(err=>alert(err.message));
}
function loginUser(){
  const email=document.getElementById("email").value;
  const password=document.getElementById("password").value;
  auth.signInWithEmailAndPassword(email,password)
  .then(()=>alert("Connexion réussie !"))
  .catch(err=>alert(err.message));
}

// ===== MARKETPLACE =====
function addProduct(){
  const name=document.getElementById("prodName").value;
  const file=document.getElementById("prodImg").files[0];
  const pay=document.getElementById("payMethod").value;
  const time=new Date().toLocaleString();
  if(!file){alert("Ajouter une image"); return;}
  const storageRef=storage.ref('products/'+file.name);
  storageRef.put(file).then(snap=>{
    snap.ref.getDownloadURL().then(url=>{
      const prodRef=db.ref('products').push();
      prodRef.set({name,url,pay,time});
    });
  });
}
db.ref('products').on('value',snap=>{
  const grid=document.getElementById("products");
  grid.innerHTML="";
  snap.forEach(prod=>{
    const p=prod.val();
    const div=document.createElement("div");
    div.className="card";
    div.innerHTML=`<h3>${p.name}</h3><img class="agri" src="${p.url}"><p>${p.pay} | ${p.time}</p>`;
    grid.appendChild(div);
  });
});

// ===== CHAT =====
function sendMsg(){
  const input=document.getElementById("chatInput");
  if(input.value.trim()==="") return;
  const msgRef=db.ref('chat').push();
  msgRef.set({msg:input.value,time:new Date().toLocaleString()});
  input.value="";
}
db.ref('chat').on('value',snap=>{
  const box=document.getElementById("chatBox");
  box.innerHTML="";
  snap.forEach(m=>{
    const mVal=m.val();
    box.innerHTML+=`<p><b>Agriculteur :</b> ${mVal.msg} <small>(${mVal.time})</small></p>`;
  });
  box.scrollTop=box.scrollHeight;
});

// ===== GEO =====
function geo(){
navigator.geolocation.getCurrentPosition(pos=>{
const lat=pos.coords.latitude;
const lon=pos.coords.longitude;
document.getElementById("geoResult").innerText=`Latitude: ${lat} Longitude: ${lon}`;
const mapDiv=document.getElementById("map");
mapDiv.innerHTML=`<iframe width="100%" height="300" src="https://maps.google.com/maps?q=${lat},${lon}&z=15&output=embed"></iframe>`;
});
}

// ===== STATS =====
new Chart(document.getElementById("chart"),{type:"line",data:{labels:["Jan","Fev","Mar","Avr","Mai"],datasets:[{label:"Production",data:[12,19,8,15,22]}]}});

// ===== METEO =====
const WEATHER_API_KEY = "dced199e16bf91df98f41aabc3f8984b";
async function fetchWeather(){
try{
const res=await fetch(`https://api.openweathermap.org/data/2.5/weather?q=Goma,CD&appid=${WEATHER_API_KEY}&units=metric`);
const data=await res.json();
document.getElementById("weatherDesc").innerText=`${data.weather[0].description}`;
document.getElementById("weatherTemp").innerText=`Temp: ${data.main.temp}°C`;
document.getElementById("weatherHum").innerText=`Humidité: ${data.main.humidity}%`;
document.getElementById("weatherWind").innerText=`Vent: ${data.wind.speed} m/s`;
const sunrise=new Date(data.sys.sunrise*1000).toLocaleTimeString();
const sunset=new Date(data.sys.sunset*1000).toLocaleTimeString();
document.getElementById("weatherSun").innerText=`Lever: ${sunrise} | Coucher: ${sunset}`;
}catch(e){document.getElementById("weatherCard").innerText="Météo non disponible";}
}
fetchWeather();

// ===== IA GPT =====
const OPENAI_KEY="dced199e16bf91df98f41aabc3f8984b";
async function askAI(){
const q=document.getElementById("aiInput").value;
const rBox=document.getElementById("aiBox");
rBox.innerHTML+="<p>Analyse en cours...</p>";
const res=await fetch("https://api.openai.com/v1/responses",{
method:"POST",
headers:{
"Content-Type":"application/json",
"Authorization":`Bearer ${OPENAI_KEY}`
},
body:JSON.stringify({model:"gpt-5-nano",input:q})
});
const data=await res.json();
const answer=data.output_text || "Aucune réponse";
rBox.innerHTML+=`<p>${answer}</p>`;
}
async function askAIHome(){
const q=document.getElementById("aiInputHome").value;
const rBox=document.getElementById("aiBoxHome");
rBox.innerHTML+="<p>Analyse en cours...</p>";
const res=await fetch("https://api.openai.com/v1/responses",{
method:"POST",
headers:{
"Content-Type":"application/json",
"Authorization":`Bearer ${OPENAI_KEY}`
},
body:JSON.stringify({model:"gpt-5-nano",input:q})
});
const data=await res.json();
const answer=data.output_text || "Aucune réponse";
rBox.innerHTML+=`<p>${answer}</p>`;
}
</script>
</body>
</html>
